import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.RH_Wq4ov.js";const n={customer_request:"客户提出需求",ai_analysis:"AI分析",ai_formula:"AI配方",order_dispatch:"派单",perfumer_prep:"配香",perfumer_adjust:"调整",application:"应用",evaluation:"评香",quality_check:"质检",customer_feedback:"反馈",completed:"完成"};function _(){const[l,u]=s.useState([]),[a,c]=s.useState(""),[o,d]=s.useState("customer_request");async function r(){const t=await fetch("/api/orders");u(await t.json())}async function h(){a.trim()&&(await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customerName:a,status:o})}),c(""),d("customer_request"),r())}async function p(t){const i=["customer_request","ai_analysis","ai_formula","order_dispatch","perfumer_prep","perfumer_adjust","application","evaluation","quality_check","customer_feedback","completed"],m=i.indexOf(t.status),x=i[Math.min(m+1,i.length-1)];await fetch(`/api/orders/${t.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:x})}),r()}return s.useEffect(()=>{r()},[]),e.jsxs("div",{children:[e.jsxs("div",{style:{display:"flex",gap:8,marginBottom:12},children:[e.jsx("input",{placeholder:"客户名称",value:a,onChange:t=>c(t.target.value)}),e.jsx("select",{value:o,onChange:t=>d(t.target.value),children:Object.keys(n).map(t=>e.jsx("option",{value:t,children:n[t]},t))}),e.jsx("button",{onClick:h,children:"新增订单"})]}),e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"订单号"}),e.jsx("th",{children:"客户"}),e.jsx("th",{children:"状态"}),e.jsx("th",{children:"操作"})]})}),e.jsx("tbody",{children:l.map(t=>e.jsxs("tr",{children:[e.jsx("td",{children:t.id}),e.jsx("td",{children:t.customerName}),e.jsx("td",{children:n[t.status]??t.status}),e.jsx("td",{children:e.jsx("button",{onClick:()=>p(t),children:"推进"})})]},t.id))})]})]})}export{_ as default};
